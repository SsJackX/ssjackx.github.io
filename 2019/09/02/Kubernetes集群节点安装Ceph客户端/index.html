<!DOCTYPE html>
<html lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="UTF-8">

    

    

    <title>Kubernetes集群节点安装Ceph客户端 | SsJackX</title>
    <meta name="author" content="SsJackX">
    <meta name="version" content="1.0.0">
    <meta name="keywords" content>
    <meta name="description" content="1 环境（1）CentOS 7.5（2）Kubernetes 1.122 Kubernetes集群节点配置国内yum源和epel源（1）首先进入/etc/yum.repos.d/目录下，新建一个repo_bak目录，用于保存系统中原来的repo文件。12345[root@localhost ~]# cd /etc/yum.repos.d/[root@localhost yum.repos.d]# mkdir repo_bak[root@localhost yum.repos.d]# ...">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">

    
    
    <link rel="icon" href="/images/favicon.ico">
    

    <link rel="stylesheet" href="/css/style.css">
</head>
<body>

    <main class="app">
        <header class="header clearfix">
    <div id="nav" class="nav">
    <div class="nav-mobile">
        <button id="open-panel" class="open-panel nav-mobile-item"><i class="icon-documents"></i></button>
        <h1 class="nav-mobile-title nav-mobile-item">SsJackX</h1>
        <button id="open-menus" class="open-panel nav-mobile-item"><i class="icon-library"></i></button>
    </div>

    <nav id="nav-inner" class="nav-inner">
        
            <a class="nav-item" href="/">
                <span class="nav-text">首页</span>
            </a>
        
            <a class="nav-item" href="/tags">
                <span class="nav-text">标签</span>
            </a>
        
            <a class="nav-item" href="/archives">
                <span class="nav-text">归档</span>
            </a>
        
            <a class="nav-item" href="/about">
                <span class="nav-text">关于</span>
            </a>
        
    </nav>
</div>

    <aside id="aside" class="aside">
    <div id="aside-mask" class="aside-mask"></div>
    <div id="aside-inner" class="aside-inner">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit"><i class="icon-search-stroke"></i></button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>

        
        
        
        

        
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-环境"><span class="toc-number">1.</span> <span class="toc-text">1 环境</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-Kubernetes集群节点配置国内yum源和epel源"><span class="toc-number">2.</span> <span class="toc-text">2 Kubernetes集群节点配置国内yum源和epel源</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-安装Ceph-common（mimic版本）"><span class="toc-number">3.</span> <span class="toc-text">3 安装Ceph-common（mimic版本）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-访问Ceph集群"><span class="toc-number">4.</span> <span class="toc-text">4 访问Ceph集群</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-参考资料"><span class="toc-number">5.</span> <span class="toc-text">5 参考资料</span></a></li></ol>
        
    </div>
</aside>

</header>

        <div id="content" class="content"><article class="article" itemscope itemprop="blogPost">
    
    <header class="article-header">
        
        <h1 itemprop="name">
            Kubernetes集群节点安装Ceph客户端
        </h1>
        
        <div class="article-meta clearfix">
            <a class="article-date" href="http://yoursite.com/2019/09/02/Kubernetes集群节点安装Ceph客户端/index.html">
    
    <i class="icon-calendar"></i>
    
    <time datetime="2019-09-02T11:54:54.000Z" itemprop="datePublished">2019-09-02</time>
</a>

            
<div class="article-tag-list">
    <i class="icon-tag"></i>
    <a class="article-tag-link" href="/tags/ceph/">ceph</a>, <a class="article-tag-link" href="/tags/kubernetes/">kubernetes</a>
</div>


        </div>
    </header>
    
    <section class="article-body markdown-body">
        
        <h2 id="1-环境"><a href="#1-环境" class="headerlink" title="1 环境"></a>1 环境</h2><p>（1）CentOS 7.5</p>
<p>（2）Kubernetes 1.12</p>
<h2 id="2-Kubernetes集群节点配置国内yum源和epel源"><a href="#2-Kubernetes集群节点配置国内yum源和epel源" class="headerlink" title="2 Kubernetes集群节点配置国内yum源和epel源"></a>2 Kubernetes集群节点配置国内yum源和epel源</h2><p>（1）首先进入<code>/etc/yum.repos.d/</code>目录下，新建一个repo_bak目录，用于保存系统中原来的repo文件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# cd /etc/yum.repos.d/</span><br><span class="line"></span><br><span class="line">[root@localhost yum.repos.d]# mkdir repo_bak</span><br><span class="line"></span><br><span class="line">[root@localhost yum.repos.d]# mv *.repo repo_bak/</span><br></pre></td></tr></table></figure>

<p>（2）在CentOS中配置使用网易和阿里的开源镜像。</p>
<p>前往网易和阿里开源镜像站点下载系统对应版本的repo文件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost yum.repos.d]# wget http://mirrors.aliyun.com/repo/Centos-7.repo</span><br><span class="line"></span><br><span class="line">[root@localhost yum.repos.d]# wget http://mirrors.163.com/.help/CentOS7-Base-163.repo</span><br><span class="line"></span><br><span class="line">[root@localhost yum.repos.d]# ls</span><br><span class="line">Centos-7.repo  CentOS-Base-163.repo  repo.bak</span><br></pre></td></tr></table></figure>

<p>或者手动下载repo文件并上传到<code>/etc/yum.repos.d/</code>目录。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 网易开源镜像站URL</span><br><span class="line"># http://mirrors.163.com/.help/centos.html</span><br><span class="line"># 阿里开源镜像站URL</span><br><span class="line"># https://opsx.alibaba.com/mirror?lang=zh-cn</span><br></pre></td></tr></table></figure>

<p>（3）清除系统yum缓存并生成新的yum缓存。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost yum.repos.d]# ls        # 列出/etc/yum.repos.d/目录下的文件</span><br><span class="line">Centos-7.repo  CentOS-Base-163.repo  repo.bak</span><br><span class="line"></span><br><span class="line">[root@localhost yum.repos.d]# yum clean all     # 清除系统所有的yum缓存</span><br><span class="line">Loaded plugins: fastestmirror, langpacks</span><br><span class="line">Repository base is listed more than once in the configuration</span><br><span class="line">Repository updates is listed more than once in the configuration</span><br><span class="line">Repository extras is listed more than once in the configuration</span><br><span class="line">Repository centosplus is listed more than once in the configuration</span><br><span class="line">Cleaning repos: base extras updates</span><br><span class="line">Cleaning up everything</span><br><span class="line">Cleaning up list of fastest mirrors</span><br><span class="line"></span><br><span class="line">[root@localhost yum.repos.d]# yum makecache     # 生成yum缓存</span><br><span class="line">Loaded plugins: fastestmirror, langpacks</span><br><span class="line">Repository base is listed more than once in the configuration</span><br><span class="line">Repository updates is listed more than once in the configuration</span><br><span class="line">Repository extras is listed more than once in the configuration</span><br><span class="line">Repository centosplus is listed more than once in the configuration</span><br><span class="line">base                                                                                  | 3.6 kB  00:00:00     </span><br><span class="line">extras                                                                                | 3.4 kB  00:00:00     </span><br><span class="line">updates                                                                               | 3.4 kB  00:00:00     </span><br><span class="line">(1/12): base/7/x86_64/filelists_db                                                    | 6.7 MB  00:00:02     </span><br><span class="line">(2/12): base/7/x86_64/group_gz                                                        | 156 kB  00:00:02     </span><br><span class="line">(3/12): base/7/x86_64/other_db                                                        | 2.5 MB  00:00:01     </span><br><span class="line">(4/12): base/7/x86_64/primary_db                                                      | 5.7 MB  00:00:02     </span><br><span class="line">(5/12): extras/7/x86_64/prestodelta                                                   |  51 kB  00:00:01     </span><br><span class="line">(6/12): extras/7/x86_64/filelists_db                                                  | 494 kB  00:00:02     </span><br><span class="line">(7/12): extras/7/x86_64/other_db                                                      |  86 kB  00:00:00     </span><br><span class="line">(8/12): extras/7/x86_64/primary_db                                                    | 130 kB  00:00:01     </span><br><span class="line">(9/12): updates/7/x86_64/prestodelta                                                  | 406 kB  00:00:01     </span><br><span class="line">(10/12): updates/7/x86_64/filelists_db                                                | 2.1 MB  00:00:01     </span><br><span class="line">(11/12): updates/7/x86_64/other_db                                                    | 354 kB  00:00:00     </span><br><span class="line">(12/12): updates/7/x86_64/primary_db                                                  | 3.6 MB  00:00:01     </span><br><span class="line">Determining fastest mirrors</span><br><span class="line">Metadata Cache Created</span><br></pre></td></tr></table></figure>

<p>（4）安装epel源。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost yum.repos.d]# yum list | grep epel-release</span><br><span class="line">Repository base is listed more than once in the configuration</span><br><span class="line">Repository updates is listed more than once in the configuration</span><br><span class="line">Repository extras is listed more than once in the configuration</span><br><span class="line">Repository centosplus is listed more than once in the configuration</span><br><span class="line">epel-release.noarch                         7-9                        extras   </span><br><span class="line"></span><br><span class="line">[root@localhost yum.repos.d]# yum install -y epel-release</span><br><span class="line">Loaded plugins: fastestmirror, langpacks</span><br><span class="line">Repository base is listed more than once in the configuration</span><br><span class="line">Repository updates is listed more than once in the configuration</span><br><span class="line">Repository extras is listed more than once in the configuration</span><br><span class="line">Repository centosplus is listed more than once in the configuration</span><br><span class="line">Loading mirror speeds from cached hostfile</span><br><span class="line">Resolving Dependencies</span><br><span class="line">--&gt; Running transaction check</span><br><span class="line">---&gt; Package epel-release.noarch 0:7-9 will be installed</span><br><span class="line">--&gt; Finished Dependency Resolution</span><br><span class="line"></span><br><span class="line">Dependencies Resolved</span><br><span class="line"></span><br><span class="line">=============================================================================================================</span><br><span class="line"> Package                       Arch                    Version                 Repository               Size</span><br><span class="line">=============================================================================================================</span><br><span class="line">Installing:</span><br><span class="line"> epel-release                  noarch                  7-9                     extras                   14 k</span><br><span class="line"></span><br><span class="line">Transaction Summary</span><br><span class="line">=============================================================================================================</span><br><span class="line">Install  1 Package</span><br><span class="line"></span><br><span class="line">Total download size: 14 k</span><br><span class="line">Installed size: 24 k</span><br><span class="line">Downloading packages:</span><br><span class="line">epel-release-7-9.noarch.rpm                                                           |  14 kB  00:00:00     </span><br><span class="line">Running transaction check</span><br><span class="line">Running transaction test</span><br><span class="line">Transaction test succeeded</span><br><span class="line">Running transaction</span><br><span class="line">  Installing : epel-release-7-9.noarch                                                                   1/1 </span><br><span class="line">  Verifying  : epel-release-7-9.noarch                                                                   1/1 </span><br><span class="line"></span><br><span class="line">Installed:</span><br><span class="line">  epel-release.noarch 0:7-9                                                                                  </span><br><span class="line"></span><br><span class="line">Complete!</span><br><span class="line">[root@localhost yum.repos.d]# ls            # epel源安装成功，比原来多了一个epel.repo和epel-testing.repo文件</span><br><span class="line">Centos-7.repo  CentOS-Base-163.repo  epel.repo  epel-testing.repo  repo.bak</span><br></pre></td></tr></table></figure>

<p>（5）使用阿里开源镜像提供的epel源。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost yum.repos.d]# wget -O /etc/yum.repos.d/epel-7.repo http://mirrors.aliyun.com/repo/epel-7.repo    # 下载阿里开源镜像的epel源文件</span><br><span class="line">--2018-03-08 20:22:14--  http://mirrors.aliyun.com/repo/epel-7.repo</span><br><span class="line">Resolving mirrors.aliyun.com (mirrors.aliyun.com)... 183.2.199.237, 113.96.109.95, 113.96.109.93, ...</span><br><span class="line">Connecting to mirrors.aliyun.com (mirrors.aliyun.com)|183.2.199.237|:80... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: 1084 (1.1K) [application/octet-stream]</span><br><span class="line">Saving to: ‘/etc/yum.repos.d/epel-7.repo’</span><br><span class="line"></span><br><span class="line">100%[=================================================================================================&gt;] 1,084       --.-K/s   in 0s      </span><br><span class="line"></span><br><span class="line">2018-03-08 20:22:14 (130 MB/s) - ‘/etc/yum.repos.d/epel-7.repo’ saved [1084/1084]</span><br><span class="line"></span><br><span class="line">[root@localhost yum.repos.d]# ls</span><br><span class="line">CentOS7-Base-163.repo  Centos-7.repo  epel-7.repo  epel.repo  epel-testing.repo  repo_bak</span><br></pre></td></tr></table></figure>

<p>（6）再次清除系统yum缓存，并重新生成新的yum缓存。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost yum.repos.d]# yum clean all</span><br><span class="line">Loaded plugins: fastestmirror, langpacks</span><br><span class="line">Repository base is listed more than once in the configuration</span><br><span class="line">Repository updates is listed more than once in the configuration</span><br><span class="line">Repository extras is listed more than once in the configuration</span><br><span class="line">Repository centosplus is listed more than once in the configuration</span><br><span class="line">Repository epel is listed more than once in the configuration</span><br><span class="line">Repository epel-debuginfo is listed more than once in the configuration</span><br><span class="line">Repository epel-source is listed more than once in the configuration</span><br><span class="line">Cleaning repos: base epel extras updates</span><br><span class="line">Cleaning up everything</span><br><span class="line">Cleaning up list of fastest mirrors</span><br><span class="line"></span><br><span class="line">[root@localhost yum.repos.d]# yum makecache</span><br><span class="line">Loaded plugins: fastestmirror, langpacks</span><br><span class="line">Repository base is listed more than once in the configuration</span><br><span class="line">Repository updates is listed more than once in the configuration</span><br><span class="line">Repository extras is listed more than once in the configuration</span><br><span class="line">Repository centosplus is listed more than once in the configuration</span><br><span class="line">Repository epel is listed more than once in the configuration</span><br><span class="line">Repository epel-debuginfo is listed more than once in the configuration</span><br><span class="line">Repository epel-source is listed more than once in the configuration</span><br><span class="line">base                                                                                                                | 3.6 kB  00:00:00     </span><br><span class="line">epel                                                                                                                | 4.7 kB  00:00:00     </span><br><span class="line">extras                                                                                                              | 3.4 kB  00:00:00     </span><br><span class="line">updates                                                                                                             | 3.4 kB  00:00:00     </span><br><span class="line">(1/18): base/7/x86_64/group_gz                                                                                      | 156 kB  00:00:01     </span><br><span class="line">(2/18): base/7/x86_64/filelists_db                                                                                  | 6.7 MB  00:00:07     </span><br><span class="line">(3/18): base/7/x86_64/primary_db                                                                                    | 5.7 MB  00:00:06     </span><br><span class="line">(4/18): epel/x86_64/group_gz                                                                                        | 266 kB  00:00:01     </span><br><span class="line">(5/18): epel/x86_64/updateinfo                                                                                      | 899 kB  00:00:02     </span><br><span class="line">(6/18): epel/x86_64/prestodelta                                                                                     | 7.1 kB  00:00:00     </span><br><span class="line">(7/18): base/7/x86_64/other_db                                                                                      | 2.5 MB  00:00:05     </span><br><span class="line">(8/18): epel/x86_64/primary_db                                                                                      | 6.3 MB  00:00:04     </span><br><span class="line">(9/18): extras/7/x86_64/filelists_db                                                                                | 636 kB  00:00:00     </span><br><span class="line">(10/18): extras/7/x86_64/primary_db                                                                                 | 166 kB  00:00:00     </span><br><span class="line">(11/18): extras/7/x86_64/other_db                                                                                   | 108 kB  00:00:00     </span><br><span class="line">(12/18): extras/7/x86_64/prestodelta                                                                                | 102 kB  00:00:01     </span><br><span class="line">(13/18): epel/x86_64/other_db                                                                                       | 3.0 MB  00:00:01     </span><br><span class="line">(14/18): epel/x86_64/filelists_db                                                                                   |  10 MB  00:00:09     </span><br><span class="line">(15/18): updates/7/x86_64/filelists_db                                                                              | 3.5 MB  00:00:02     </span><br><span class="line">(16/18): updates/7/x86_64/prestodelta                                                                               | 771 kB  00:00:02     </span><br><span class="line">(17/18): updates/7/x86_64/other_db                                                                                  | 621 kB  00:00:00     </span><br><span class="line">(18/18): updates/7/x86_64/primary_db                                                                                | 6.0 MB  00:00:03     </span><br><span class="line">Determining fastest mirrors</span><br><span class="line"> * epel: mirrors.aliyun.com</span><br><span class="line">Metadata Cache Created</span><br></pre></td></tr></table></figure>

<p>（7）查看系统可用的yum源和所有的yum源。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost yum.repos.d]# yum repolist enabled</span><br><span class="line">Loaded plugins: fastestmirror, langpacks</span><br><span class="line">Repository base is listed more than once in the configuration</span><br><span class="line">Repository updates is listed more than once in the configuration</span><br><span class="line">Repository extras is listed more than once in the configuration</span><br><span class="line">Repository centosplus is listed more than once in the configuration</span><br><span class="line">Repository epel is listed more than once in the configuration</span><br><span class="line">Repository epel-debuginfo is listed more than once in the configuration</span><br><span class="line">Repository epel-source is listed more than once in the configuration</span><br><span class="line">Loading mirror speeds from cached hostfile</span><br><span class="line"> * epel: mirrors.aliyun.com</span><br><span class="line">repo id                                            repo name                                                                         status</span><br><span class="line">base/7/x86_64                                      CentOS-7 - Base - 163.com                                                          9,591</span><br><span class="line">epel/x86_64                                        Extra Packages for Enterprise Linux 7 - x86_64                                    12,382</span><br><span class="line">extras/7/x86_64                                    CentOS-7 - Extras - 163.com                                                          390</span><br><span class="line">updates/7/x86_64                                   CentOS-7 - Updates - 163.com                                                       1,941</span><br><span class="line">repolist: 24,304</span><br><span class="line"></span><br><span class="line">[root@localhost yum.repos.d]# yum repolist all</span><br><span class="line">Loaded plugins: fastestmirror, langpacks</span><br><span class="line">Repository base is listed more than once in the configuration</span><br><span class="line">Repository updates is listed more than once in the configuration</span><br><span class="line">Repository extras is listed more than once in the configuration</span><br><span class="line">Repository centosplus is listed more than once in the configuration</span><br><span class="line">Repository epel is listed more than once in the configuration</span><br><span class="line">Repository epel-debuginfo is listed more than once in the configuration</span><br><span class="line">Repository epel-source is listed more than once in the configuration</span><br><span class="line">Loading mirror speeds from cached hostfile</span><br><span class="line"> * epel: mirrors.aliyun.com</span><br><span class="line">repo id                                     repo name                                                                       status</span><br><span class="line">base/7/x86_64                               CentOS-7 - Base - 163.com                                                       enabled:  9,591</span><br><span class="line">centosplus/7/x86_64                         CentOS-7 - Plus - 163.com                                                       disabled</span><br><span class="line">contrib/7/x86_64                            CentOS-7 - Contrib - mirrors.aliyun.com                                         disabled</span><br><span class="line">epel/x86_64                                 Extra Packages for Enterprise Linux 7 - x86_64                                  enabled: 12,382</span><br><span class="line">epel-debuginfo/x86_64                       Extra Packages for Enterprise Linux 7 - x86_64 - Debug                          disabled</span><br><span class="line">epel-source                                 Extra Packages for Enterprise Linux 7 - x86_64 - Source                         disabled</span><br><span class="line">epel-testing/x86_64                         Extra Packages for Enterprise Linux 7 - Testing - x86_64                        disabled</span><br><span class="line">epel-testing-debuginfo/x86_64               Extra Packages for Enterprise Linux 7 - Testing - x86_64 - Debug                disabled</span><br><span class="line">epel-testing-source/x86_64                  Extra Packages for Enterprise Linux 7 - Testing - x86_64 - Source               disabled</span><br><span class="line">extras/7/x86_64                             CentOS-7 - Extras - 163.com                                                     enabled:    390</span><br><span class="line">updates/7/x86_64                            CentOS-7 - Updates - 163.com                                                    enabled:  1,941</span><br><span class="line">repolist: 24,304</span><br></pre></td></tr></table></figure>

<h2 id="3-安装Ceph-common（mimic版本）"><a href="#3-安装Ceph-common（mimic版本）" class="headerlink" title="3 安装Ceph-common（mimic版本）"></a>3 安装Ceph-common（mimic版本）</h2><p>为了安装速度，我们可以选用国内源。通常大家使用的国内源包括：</p>
<ul>
<li>网易 <a href="http://mirrors.163.com/ceph" target="_blank" rel="noopener"><em>http://mirrors.163.com/ceph</em></a></li>
<li>中科大 <a href="http://mirrors.ustc.edu.cn/ceph" target="_blank" rel="noopener">http://mirrors.ustc.edu.cn/ceph</a></li>
<li>阿里 <a href="http://mirrors.aliyun.com/ceph" target="_blank" rel="noopener">http://mirrors.aliyun.com/ceph</a></li>
</ul>
<p>（1）添加源。</p>
<p>给yum增加一个Ceph源(此处以网易源为例)。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# tee /etc/yum.repos.d/ceph.repo &lt;&lt;-&apos;EOF&apos;</span><br><span class="line">[Ceph]</span><br><span class="line">name=Ceph packages for $basearch</span><br><span class="line">baseurl=http://mirrors.163.com/ceph/rpm-mimic/el7/$basearch</span><br><span class="line">enabled=1</span><br><span class="line">gpgcheck=0</span><br><span class="line">type=rpm-md</span><br><span class="line">gpgkey=https://mirrors.163.com/ceph/keys/release.asc</span><br><span class="line">priority=1</span><br><span class="line"></span><br><span class="line">[Ceph-noarch]</span><br><span class="line">name=Ceph noarch packages</span><br><span class="line">baseurl=http://mirrors.163.com/ceph/rpm-mimic/el7/noarch</span><br><span class="line">enabled=1</span><br><span class="line">gpgcheck=0</span><br><span class="line">type=rpm-md</span><br><span class="line">gpgkey=https://mirrors.163.com/ceph/keys/release.asc</span><br><span class="line">priority=1</span><br><span class="line"></span><br><span class="line">[ceph-source]</span><br><span class="line">name=Ceph source packages</span><br><span class="line">baseurl=http://mirrors.163.com/ceph/rpm-mimic/el7/SRPMS</span><br><span class="line">enabled=1</span><br><span class="line">gpgcheck=0</span><br><span class="line">type=rpm-md</span><br><span class="line">gpgkey=https://mirrors.163.com/ceph/keys/release.asc</span><br><span class="line">priority=1</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>

<p>【注】若需要安装其它版本的ceph-common，只需将ceph.repo文件中的ceph版标识（mimic）进行更换即可。当前已知标识有：Jewel、Luminous、Mimic等。</p>
<p>（2）安装依赖。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# yum install -y yum-utils &amp;&amp; yum-config-manager --add-repo https://dl.fedoraproject.org/pub/epel/7/x86_64/ &amp;&amp; yum install --nogpgcheck -y epel-release &amp;&amp; rpm --import /etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-7 &amp;&amp; rm -f /etc/yum.repos.d/dl.fedoraproject.org*</span><br></pre></td></tr></table></figure>

<p>（3）安装ceph-common。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# yum -y install ceph-common</span><br></pre></td></tr></table></figure>

<p>（4）验证ceph-common。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# ceph --version</span><br><span class="line">ceph version 13.2.2 (02899bfda814146b021136e9d8e80eba494e1126) mimic （stable）</span><br></pre></td></tr></table></figure>

<h2 id="4-访问Ceph集群"><a href="#4-访问Ceph集群" class="headerlink" title="4 访问Ceph集群"></a>4 访问Ceph集群</h2><p>（1）在kubernetes集群节点主机创建/etc/ceph/目录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@k8s-g3 ~]# mkdir /etc/ceph</span><br></pre></td></tr></table></figure>

<p>（2）拷贝ceph集群的ceph.client.admin.keyring和ceph.conf文件至kubernetes节点/etc/ceph目录。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 进入ceph集群主机/etc/ceph/目录执行拷贝命令（拷贝通过ceph-deploy实现）</span><br><span class="line">[root@ceph01 ceph]# ceph-deploy admin [k8s-node-ip]</span><br></pre></td></tr></table></figure>

<p>（3）确保该密钥环文件有读权限。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 进入kubernetes集群节点主机/etc/ceph/目录，对ceph.client.admin.keyring文件执行指令</span><br><span class="line">[root@ceph01 ceph]# chmod +r ceph.client.admin.keyring</span><br></pre></td></tr></table></figure>

<p>（4）访问ceph集群成功示例。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@k8s-g3 ~]# rbd list</span><br><span class="line">Redis-master01-rbd-pv</span><br><span class="line">Redis-slave01-rbd-pv</span><br><span class="line">iapview-rbd-pv</span><br><span class="line">mysql-rbd-pv</span><br><span class="line">mysqlforsummer</span><br><span class="line">mysqlforsummer02</span><br><span class="line">rbd-for-rtcdb</span><br><span class="line">rbd-for-rtcdb-redis-master</span><br><span class="line">rbd-for-rtcdb-redis-slave</span><br><span class="line">rbd-for-rtcdb-redis-slave09</span><br></pre></td></tr></table></figure>

<h2 id="5-参考资料"><a href="#5-参考资料" class="headerlink" title="5 参考资料"></a>5 参考资料</h2><p><a href="https://www.cnblogs.com/renpingsheng/p/7845096.html" target="_blank" rel="noopener">https://www.cnblogs.com/renpingsheng/p/7845096.html</a></p>
<p><a href="https://www.cnblogs.com/styshoo/p/8397229.html" target="_blank" rel="noopener">https://www.cnblogs.com/styshoo/p/8397229.html</a></p>

        
    </section>
</article>



<div class="comments">
    <div id="comments"></div>
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>
    new Gitalk({
        clientID: "7fbe80427f54741e289f",
        clientSecret: "f34ed5fd92e54c9000bd37ba951948cb939deff5",
        repo: "ssjackx.github.io",
        owner: "ssjackx",
        admin: ["ssjackx"],
        id: "2019/09/02/Kubernetes集群节点安装Ceph客户端",
        distractionFreeMode: true,
        title: "Kubernetes集群节点安装Ceph客户端",
        body: "http://yoursite.com/2019/09/02/Kubernetes集群节点安装Ceph客户端/",
        labels: ["ceph","kubernetes"]
    }).render('comments');
    </script>
</div>

</div>
        <footer class="footer">
    Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, Theme by <a href="https://github.com/sanonz/hexo-theme-concise" target="_blank">Concise</a>

    
    <script>
        var _hmt = _hmt || [];
        (function () {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?e5fbfff843a78216314d2466ce8003d8";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>
    
</footer>

    </main>

    <script type="text/javascript" src="https://cdn.bootcss.com/jquery/1.9.0/jquery.min.js"></script>
    <script type="text/javascript">
    $(function() {
        var nodes = {
            nav: $('#nav'),
            aside: $('#aside'),
            asideInner: $('#aside-inner'),
            navInner: $('#nav-inner')
        };

        var doing = false;
        nodes.asideInner.on('webkitAnimationEnd mozAnimationEnd oAnimationEnd oanimationend animationend', function() {
            if (nodes.aside.hasClass('mobile-open')) {
                nodes.aside.removeClass('mobile-open');
            } else {
                nodes.aside.removeClass('mobile-close panel-show');
            }
            doing = false;
        });
        $('#open-panel, #aside-mask').on('click', function() {
            if (doing) {
                return;
            }
            
            if (nodes.aside.hasClass('panel-show')) {
                nodes.aside.addClass('mobile-close');
            } else {
                nodes.aside.addClass('mobile-open panel-show');
            }
        });
        $('#open-menus').on('click', function() {
            nodes.navInner.slideToggle();
        });

        if (window.innerWidth <= 960) {
            setTimeout(function() {
                nodes.navInner.slideUp();
            }, 3000);
        }
    });
    </script>
    
        <script type="text/javascript" src="/js/scrollspy.min.js"></script>
        <script type="text/javascript">
        $(document.body).scrollspy({target: '#aside-inner'});
        </script>
    

</body>
</html>
